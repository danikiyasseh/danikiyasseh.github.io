<!DOCTYPE HTML>
<!--
	Spectral by Pixelarity
	pixelarity.com @pixelarity
	License: pixelarity.com/license
-->
<html>
	<head>
		<link rel="icon" href="">
		<title>Dani Kiyasseh | Blog - CROCS </title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<!--[if lte IE 8]><script src="assets/js/ie/html5shiv.js"></script><![endif]-->
		<link rel="stylesheet" href="../../assets/css/main.css" />
		<link rel="stylesheet" href="https://cdn.rawgit.com/jpswalsh/academicons/master/css/academicons.min.css">
		<!--[if lte IE 8]><link rel="stylesheet" href="assets/css/ie8.css" /><![endif]-->
		<!--[if lte IE 9]><link rel="stylesheet" href="assets/css/ie9.css" /><![endif]-->
		<script type="text/x-mathjax-config">
            MathJax.Hub.Config({
                               tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
                               });
        </script>
        <script type="text/javascript"
  			src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
		</script>
		<script>
		  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

		  ga('create', 'UA-97381584-1', 'auto');
		  ga('send', 'pageview');

		</script>

		
		

	</head>
  
  
	<body>

		<!-- Page Wrapper -->
			<div id="page-wrapper">

				<!-- Header -->
					<header id="header">
						<h1><a href="../../index.html">Dani Kiyasseh</a></h1>
						<nav id="nav">
							<ul>
								<li class="special">
									<a href="#menu" class="menuToggle"><span>Menu</span></a>
									<div id="menu">
										<ul>
											<li><a href="../../index.html">Home</a></li>
											<li><a href="../../index.html#aboutme">About Me</a></li>
											<li><a href="../../index.html#experience">Experience</a></li>
											<li>&mdash;</li>
											<li><a href="../../publications.html">Publications</a></li>
											<li><a href="../index.html">Blog</a></li>
											<li><a href="../../datasets.html">Datasets</a></li>											
										</ul>
									</div>
								</li>
							</ul>
						</nav>
					</header>

				<!-- Main -->
					<article id="main">
						<section class="wrapper style5">

							<div class="inner">
								<h2>
								<center>
									CROCS: Clustering and Retrieval of Cardiac Signals Based on Patient Disease Class, Sex, and Age
								</center>
								</h2>
								
								<p>
								<center>
									Friday, October 8th, 2021
								</center>
								</p>
								
								<p>
								<center>
									Dani Kiyasseh
								</center>
								</p>
								
								<p>
								Clinical databases are commonly used by stakeholders within healthcare to search for relevant data points (e.g., medical records) and extract information (e.g., patient attributes) 
								from such data points. For example, cardiologists extract disease information from cardiac signals, researchers search for relevant patients to enroll in a clinical trial, and medical 
								educators search for examplar data points with which to educate the next generation of medical students. 
								</p>
								<p>
								The existing manual search-and-extract process, however, is hampered by two main
								obstacles; the rapid growth of large-scale clinical databases, and the increased prevalence of unlabelled data points within such databases. Whereas the former implies that the existing 
								manual search-and-extract process scales poorly to large databases, the latter deems the search process intractable to begin with. For example, how would researchers go about searching 
								for relevant patients to include in a clinical trial when such patients are unlabelled with patient attribute information? We propose to address these challenges via the frameworks of 
									<a id='overwhite' href="https://en.wikipedia.org/wiki/Cluster_analysis"><u>clustering</u></a> and <a id='overwhite' href="https://en.wikipedia.org/wiki/Information_retrieval"><u>retrieval</u></a>, as explained next. 
								</p>
								
								<h4>
								Clustering and Retrieval
								</h4>
								<p>
								We aim to extract patient attribute information from unlabelled data points and search for relevant unlabelled data points within a clinical database. To extract information from unlabelled data points, 
								we exploit a supervised clustering approach. In this setting, we learn a set of cluster centroids, each of which is associated with a unique set of patient attributes (e.g., patient disease class, sex, and age).
								Given an unlabelled data point, we assign it to the cluster centroid to which it is closest, and by extension extract its associated patient attribute information. In essence, we have now annotated this
								unlabelled data point, thus allowing stakeholders within healthcare to exploit this data point for downstream analyses pertaining to model fairness, error analysis, and beyond. 
								</p>
								</p>
								To retrieve relevant data points from a clinical database, we exploit an information retrieval approach. In this setting, we learn query embeddings (read: vectors), each of which is associated with a unique set of 
								patient attributes. We then use this query to search through the clinical databases, identify unlabelled data points to which it is most similar, and thus retrieve those that are most relevant. This capability allows
								stakeholders to retrieve patients from clinical databases that otherwise would have been overlooked, a pertinent <a id='overwhite' href="https://hbr.org/2021/06/addressing-demographic-disparities-in-clinical-trials#:~:text=Clinical%20trials%20primarily%20enroll%20white,16%25%20of%20patients%20in%20trials."><u>challenge for clinical trial enrollment</u></a>. 
								As such, our approach can, for example, allow researchers to recruit a more demographically diverse patient population for clinical trials, thus strengthening the generalizability of the outcomes of such trials. 
								</p>
								<p>		
								In our research, we focus on explicitly learning the cluster centroids (for the clustering setting) and query embeddings (for the retrieval setting). In practice, these are one and the same, and we will refer to them 
								as clinical prototypes (read: vectors that summarize a unique set of patient attributes).
								</p>
								<p>
								<center>
									<img src="./images/clustering_and_retrieval.png" style="width: 40vw;" /> 									
								</center>
								</p>
								
								<h4>
								CROCS Framework
								</h4>
								<p>
									In our NeurIPS 2021 <a id='overwhite' href="https://arxiv.org/abs/2011.14230"><u>paper</u></a>, we proposed to learn the aforementioned clinical prototypes via a supervised contrastive learning framework, entitled CROCS. To better understand 
								how this works, let us consider the visualization below. For an electrocardiogram (ECG) signal associated with a set of patient attributes, we first extract
								its representation by passing it through a feature extractor. This representation is then attracted to (or repelled from) the clinical prototypes which are associated with a set of
								patient attributes. Specifically, it is most strongly attracted to clinical prototypes reflecting the same exact set of patient attributes, and less attracted to those with some overlap in the patient attributes.
								At the same time, the representation is repelled from clinical prototypes associated with a different disease class. 
								</p>	
								<p>		
								In doing so, we learn embeddings that are attribute-specific and which can serve as either 
								centroids in the clustering setting or queries in the retrieval setting. Note that clinical prototypes are embeddings that are learned in an end-to-end manner, similar to how network parameters would ordinarily be learned. 
								</p>
								<p>
								<center>
									<img src="./images/CROCS_GIF.gif" alt="description of gif" /> 									
								</center>
								</p>

								<h4>
								Interpretable Clinical Prototypes 
								</h4>
								<p>
								We also impose an additional constraint on the clinical prototypes to increase their level of interpretability. More precisely, we encourage prototypes that are associated with a similar set of patient attributes
								to be more similar to one another. For example, prototypes that share the same disease class and sex group but differ according to the age group should be more similar to one another than those from distinct sex and 
								age groups. Doing so results in the visualization below, where we illustrate a low-dimensional projection of the learned clinical prototypes (marker style = disease class, colour = sex group, marker size = age group).
								The main takeaway here is that the clinical prototypes adopt a semantically meaningful arrangement, as desired. 
								</p>
								<p>
								<center>
									<img src="./images/semantic_arrangement.png" style="width: 25vw;" /> 									
								</center>
								</p>
								
								<h4>
								Visualizing Clinical Prototypes
								</h4>
								<p>
								When we project the clinical prototypes (and the data points in an unseen held-out set) onto a low-dimensional space (e.g., via UMAP), we arrive at the visualization below. Representations of instances in the validation set are
								shown as small, coloured points. Traditional prototypes, which are av average of representations associated with a unique set of patient attributes, are shown as large, black points. Clinical prototypes are shown as large, coloured
								point. We see that these clinical prototypes (large, coloured points) are disease class-specific and align well with the class labels of the data points in the unseen held-out set. This bodes well for their eventual use in the clustering and retrieval
                						settings. They are also distinct from traditional prototypes (large, black points). 
								</p>
								<p>
								<center>
									<img src="./images/chapman_umap.png" style="width: 30vw;" /> 									
								</center>
								</p>
								
								<h4>
								Clustering Results
								</h4>
								<p>
								In the clustering setting, we exploited the learned clinical prototypes as centroids of attribute-specific clusters. Here, we compare their performance to that of baseline methods when clustering multiple 
                						patient attributes (namely, cardiac arrhythmia disease class, sex, and age). The main takeaways is that CROCS outperforms the state-of-the-art method, DTC, across datasets and attributes. As such, if you are looking to cluster 
								data points according to multiple patient attributes, we recommend using the CROCS framework. 
								</p>
								<p>
								<center>
									<img src="./images/clustering_results.png"  style="width: 40vw;" /> 									
								</center>
								</p>
								
								<h4>
								Retrieval Results
								</h4>
								<p>  
								In the retrieval setting, we exploit the learned clinical prototypes as queries to search through a database of unlabelled cardiac signals and retrieve those which are most similar. Doing so for a particular
								clinical prototype (associated with sinus rhythm disease class, male sex group, and the age group under 25 years old) leads to the results below. We find that this prototype is closer to unseen data points which
								belong to the same disease class than to those from a different class. This suggests that CROCS is likely to retrieve relevant cardiac signals, a claim supported by the relevance of the six closest ECG signals 
								(green bounding boxes indicate relevant cardiac signals). Such behaviour is in stark contrast to queries learned by DTC, which struggle to retrieve relevant cardiac signals. 
								</p>
								<p>
								<center>
									<img src="./images/retrieval_results.png"  style="width: 45vw;" /> 									
								</center>
								</p>
								
								<h4>
								Acknowledgements
								</h4>
								<p>  
								We would like to thank Antong Chen for reviewing a preliminary version of the associated manuscript. We would also like to thank <a id='overwhite' href="https://www.youtube.com/watch?v=uQk9VTLvzLA"><u>Nagat Al-Saghira</u></a> and <a id='overwhite' href="https://www.youtube.com/watch?v=C6SPcxQdK8M"><u>Mohammed Abdel Wahab</u></a> for lending us their voice. 
								</p>
								
							    </br>
							
							</div>
						</section>
					</article>
    
		
			</div>

		<!-- Scripts -->
			<script src="../../assets/js/jquery.min.js"></script>
			<script src="../../assets/js/jquery.scrollex.min.js"></script>
			<script src="../../assets/js/jquery.scrolly.min.js"></script>
			<script src="../../assets/js/skel.min.js"></script>
			<script src="../../assets/js/util.js"></script>
			<!--[if lte IE 8]><script src="assets/js/ie/respond.min.js"></script><![endif]-->
			<script src="../../assets/js/main.js"></script>
				
				
  	</body>
	
</html>
